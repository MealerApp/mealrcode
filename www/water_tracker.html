<div class="water_glass"><a href="#" onclick="addCount();"><img src="img/glass.png" width='60%'></a></div>
<div class="water_content">
  <h2 class="glass_count"><span id='count'></span>/8</h2>
  <h1>Glasses Today</h1>
</div>
<script>
  var currentCount = currentUser.get('water_count');
  
  $('#count').html(currentCount);
  function addCount() {
    currentCount += 1;  
    if (currentCount === 8){  
      currentUser.addUnique('badges', 'u1Gh44zpf3'); // winning a badge
      
    	var r = confirm("You just drank 8 glasses of water! Click OK to redeem your badge.");
    	submitBadgePost();
  		if (r==true) {
  		  $('#mainOutlet').load('redeem.html');
  		}
    }
    else {
     
      currentUser.increment('water_count', 1);
    }
    $('#count').html(currentCount);
    Parse.User.current().save();

  }

  function submitBadgePost() {
    var Post = Parse.Object.extend("Post");          
    var post = new Post();
    post.set("type",'badge');
    var badgePost = currentUser.getUsername() + " just won the water badge"; 
    console.log(badgePost);
    
  }
  
  
  function submitPost() {
  var Post = Parse.Object.extend("Post");          
  var post = new Post();
  var text = $('#postText').val();
  
  var hasImage = document.getElementById("myImage").getAttribute('src') != '';
  
  if (hasImage){
    var parseFile = new Parse.File('picture.jpg', {base64:imagedata});
    parseFile.save().then(function() {
      console.log(' a pic ');
     post.set("picture",parseFile);
     post.set("type", "picture");	
   });
  } 
  else {
    post.set("type", "text");
  }
  
  post.set("text", text);
  
  post.save(null, {
    success: function(post) {
          // Execute any logic that should take place after the object is saved.
          alert('Updated your status!');
          // TODO: now reload the posts again to get the new one to show
        },
        error: function(post, error) {
          // Execute any logic that should take place if the save fails.
          // error is a Parse.Error with an error code and description.
          alert('Failed to create new object, with error code: ' + error);
        }
      });
}    

  </script>
